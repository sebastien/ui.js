<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<!--
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sebastien/ui.js/src/css/uijs.css" type="text/css" media="all">
		-->
		<title>UIjs: Tree View</title>
		<link
			rel="stylesheet"
			href="../lib/css/ui.css"
			type="text/css"
			media="all"
		/>
		<script type="importmap">
			{ "imports": { "@ui.js": "/lib/js/ui.js", "@ui/": "/lib/js/ui/" } }
		</script>
	</head>
	<body>
		<div class="row fit-screen stretched lined nogap">
			<div
				class="stack w-2col bd shadow-2 rounded shadow-left shadow-8 bg-3 pad-4 scroll-v"
			>
				<slot
					template="Tree"
					items="(fetch('../lib/json/taxonomy.json').then(_=>_.json()))"
				/>
			</div>
		</div>
		<!-- ------------------------------------------------------------------
		TEMPLATES
		------------------------------------------------------------------- -->
		<template name="Tree" in:items>
			<div class="stack fill lined fit-h indent-2">
				<ul class="stack" x:for="item=items">
					<slot template="Node" item="item"></slot>
				</ul>
			</div>
		</template>

		<template name="Node" in:item>
			<li x:match="children=item.children">
				<slot x:when="{children?.length}">
					<div class="row item selectable pad-2" on:click="!Toggle">
						<span class="icon">ðŸ“‚</span>
						<span class="label" out:content="item.label|debug"
							>â€¦</span
						>
					</div>
					<ul class="stack items" x:for="item.children">
						<slot template="Node" item="."></slot>
					</ul>
				</slot>
				<slot x:otherwise>
					<div class="row item selectable pad-2">
						<span class="icon">ðŸ“„</span>
						<span class="label" out:content="item.label|debug"
							>â€¦</span
						>
					</div>
				</slot>
			</li>
		</template>
		<script type="module">
			import { controller } from "@ui.js";
			const Node = ({ use, on, scope }) => {
				const isExpanded = use.local("isExpanded", true);
				on.Toggle((event) => {
					console.log("Toggle item");
				});
			};
			export default controller(Node);
		</script>
		<!-- ------------------------------------------------------------------
		MAIN SCRIPT
		------------------------------------------------------------------- -->
		<script type="module">
			// import ui from "https://cdn.jsdelivr.net/gh/sebastien/ui.js/src/js/ui.js";
			import ui from "@ui.js";
			ui();
		</script>
	</body>
</html>
