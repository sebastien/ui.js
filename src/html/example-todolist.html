<!DOCTYPE html>
<html>
<body>
	<div id="placeholder" />

		<div class="ui" data-ui="Todo" data-state="[{label:'Buy milk',checked:true}]" ></div>

	<template id="Todo">
		<div class="Todo">
			<h3>Simple todo list</h3>
			<ul>
				<slot name="items" out-contents=".|TodoItem" />
			<ul>
		</div>
		<script type="module">
		</script>
	</template>

	<!--
	<template id="TodoItem">
		<div class="TodoItem">
			<input class="out" when=".edited"  type="checkbox" out-value=".checked|bool" />
			<input class="out" when=".edited|not" type="text" out-value=".label" />
		</div>
	</template>
	-->


	<script type="module">
		import ui from "../js/ui.js"
		// -- doc
		// Utility function to reload the page automatically when the given URL changes.
		export const reload = (url, period = 2000.0) => {
		  const state = { lastModified: undefined, stop: false, interval: undefined };
		  const update = () => {
			if (state.stop) {
			  window.clearInterval(state.interval);
			}
			fetch(url, { method: "HEAD" }).then((_) => {
			  const lastModified = _.headers.get("last-modified");
			  if (state.lastModified && state.lastModified !== lastModified) {
				state.lastModified = lastModified;
				console.log("ui.reload: Monitor has changed, reloading", { url });
				window.location.reload();
			  } else {
				state.lastModified = lastModified;
			  }
			});
		  };
		  state.interval = window.setInterval(update, period);
		  return state;
		};
		reload("../js/ui.js");

		ui()

	</script>
</body>
</html>
